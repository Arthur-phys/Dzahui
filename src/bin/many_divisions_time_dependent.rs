use dzahui::{DzahuiWindow, DzahuiWindowBuilder, DiffussionParams};

/// Simple time dependent diffussion example with a mesh with many divisions.
fn main() {
    /* TIME INDEPENDENT DIFFUSSION */
    let diffussion_params = DiffussionParams::time_dependent()
    .b(1.0)
    .mu(1.0)
    .boundary_conditions(1.0, 15.0)
    .initial_conditions([
        3345.922491099419,
9914.7079072427,
8076.573225057649,
5932.987303413891,
6880.051237256575,
6781.45624425759,
4981.115347393128,
8490.493199741235,
950.7391629122375,
8784.969750632528,
4717.458473568527,
3645.801242770821,
4962.534113427682,
3538.678203696499,
7685.161402221919,
88.09383297716633,
4513.962820521166,
8764.265091204787,
1955.804977461254,
3458.599411932366,
8129.174850711292,
7706.691415659873,
1867.0473015054001,
5190.332162061071,
772.4834240096424,
240.64111013503918,
3450.880452492181,
392.3587506109416,
9637.064430210821,
7171.78048987769,
4701.973106603146,
5333.752190528625,
933.2285560350739,
81.59197517327298,
2800.087549464725,
4402.445201148491,
1123.2503663925231,
4742.0561356726475,
6964.539071140495,
9119.55862450937,
2264.6483214281698,
6601.151911250241,
7502.409828341898,
3608.3730460542083,
5495.296315264566,
5558.0882414922335,
1151.4509601596933,
5178.35243182056,
554.1240068237663,
7763.126456316128,
8032.794610889044,
5224.2240774516595,
4372.283032975725,
2831.3929745040355,
9623.174337880348,
3561.018387353383,
4426.109266869837,
4003.3603140045957,
7182.927541030256,
5324.473727901626,
9561.348971904355,
1884.230152910904,
186.74229625738724,
5132.245295129792,
1353.2281772422893,
6547.317583710006,
1631.6780757546724,
6824.153568598516,
8215.042588315257,
3642.589082731147,
5583.291609833949,
5197.240545196727,
1537.22816034492,
2036.501775684414,
2889.552127171522,
9217.024003353947,
5097.0470950219415,
7709.279674941503,
4984.240694963891,
2003.1782337228954,
9349.620035015952,
6941.248692064681,
9383.39010124584,
1377.5338123448112,
4557.9223290083955,
4974.50473116735,
4897.081211539868,
973.9960286451566,
3361.1404733883155,
6979.133944756676,
710.9383159817373,
8571.98688090069,
5381.540021724942,
5176.218324557147,
5559.366162148029,
4181.559800218631,
8873.435555520799,
1736.013163723753,
8079.73297450228,
9718.739236478736,
3347.4366060119855,
1725.8911800399,
15.608026988225276,
6984.147479477207,
4440.718458067679,
8995.587245549148,
1037.5885710330856,
6766.678341546933,
2053.4781470093744,
9845.289779640985,
7651.887570422504,
4195.531688970505,
45.15639670157334,
5883.054213238586,
9471.088090585064,
2086.87751090214,
509.6502367301226,
1384.3585117062396,
3035.50801453919,
4301.118762458923,
3730.566892107299,
5191.765867144633,
366.8573443775025,
4708.166662120091,
6800.073418679143,
1541.3057415697351,
1707.864251869331,
7630.785171080741,
8000.591939178534,
6923.402873746756,
5906.988531327722,
3569.570046689545,
2737.902496530099,
7414.767455906946,
2503.8087870924974,
2594.737888086114,
2921.287538543248,
7491.239367429143,
6670.075241892334,
1959.453260860886,
4087.117067931971,
245.68293549409148,
1723.1471421273116,
3284.8883420196385,
2454.330126018931,
4897.301608466517,
6035.949424373651,
7780.29310376001,
1699.0165941888613,
127.68594645138798,
8744.03153079824,
1394.681284144762,
765.5347130041234,
1648.2881515679637,
9029.209724368648,
5277.738076062478,
4398.342978714119,
7895.173306262209,
2832.0315789526785,
1765.4910609286146,
4030.184431386932,
4717.610760833452,
3.869169833817798,
9079.399196561348,
719.1502489356217,
6663.492513526547,
347.207979650429,
8553.212990132855,
6319.9067632453025,
3135.5669664913667,
5138.318322211431,
3186.295279989737,
6535.881781152666,
1900.9894427668917,
9673.453299310311,
9841.696990978564,
7018.9987241268955,
68.45536218556659,
8409.498280677395,
6857.655444743039,
9093.170494263173,
8092.320551146541,
4932.069025787076,
3787.576898949113,
1282.5183278856643,
215.82785813814786,
5485.572802813006,
4264.800717396521,
4424.3072136012615,
3601.337246487453,
5203.209519124252,
7921.241655166672,
80.31098815465486,
466.4392699520559,
6855.811865065277,
6550.231196324971,
6122.664574323316,
9635.034338559197,
        ])
    .build();
    
    let window_builder: DzahuiWindowBuilder = DzahuiWindow::builder("./assets/1dbar_many_divisions.obj")
        .solve_1d_time_dependent_diffussion(diffussion_params)
        .with_integration_iteration(150).with_time_step(0.000001).enable_height_multiplier(15_f64);

    let window = window_builder.build();
    window.run();
    
}